sap.ui.define(["sap/ui/core/mvc/ControllerExtension","sap/ui/model/json/JSONModel","sap/m/MessageToast","sap/base/security/URLWhitelist","sap/ui/core/message/Message","sap/ui/core/message/MessageType"],function(e,t,n,i,l,r){"use strict";return e.extend("ns.labelprintingj.ext.controller.ItemObjController",{onChange:function(e){console.log("change triggered");let t="";let n="";let i=e.getSource().getId();let l=this.getView().byId("ns.labelprintingj::OutbDeliveryItemObjectPage--fe::CustomSubSection::PrintPreview").getVisible();if(i=="ns.labelprintingj::OutbDeliveryItemObjectPage--fe::HeaderFacetCustomContainer::RenderTemplate--printQId"){t=e.getParameter("selectedItem").getProperty("key");if(t==""){this.getView().byId("ns.labelprintingj::OutbDeliveryItemObjectPage--fe::CustomAction::Print").setEnabled(false)}else{if(l){this.getView().byId("ns.labelprintingj::OutbDeliveryItemObjectPage--fe::CustomAction::Print").setEnabled(true)}else{this.getView().byId("ns.labelprintingj::OutbDeliveryItemObjectPage--fe::CustomAction::Print").setEnabled(false)}}}else{n=e.getParameter("selectedItem").getProperty("key");if(n==""){this.getView().byId("ns.labelprintingj::OutbDeliveryItemObjectPage--fe::CustomAction::PrintPreview").setEnabled(false)}else{this.getView().byId("ns.labelprintingj::OutbDeliveryItemObjectPage--fe::CustomAction::PrintPreview").setEnabled(true)}}},print:function(e){let t=this.getView().byId("ns.labelprintingj::OutbDeliveryItemObjectPage--fe::HeaderFacetCustomContainer::RenderTemplate--printQId").getProperty("selectedKey");let i=this.getView().byId("ns.labelprintingj::OutbDeliveryItemObjectPage--fe::CustomSubSection::PrintPreview--pdfViewId").getSource();let l=this.getView().byId("ns.labelprintingj::OutbDeliveryItemObjectPage--fe::FormContainer::ItemDetails::FormElement::DataField::DeliveryDocument::Field-content").getContentDisplay().mProperties.text+this.getView().byId("ns.labelprintingj::OutbDeliveryItemObjectPage--fe::FormContainer::ItemDetails::FormElement::DataField::DeliveryDocumentItem::Field-content").getContentDisplay().mProperties.text+".pdf";fetch(i).then(e=>e.blob()).then(i=>{const r=new FileReader;r.onload=function(){const i=r.result;console.log(i);const o=i.split(",")[1];console.log(o);console.log(typeof o);let s=e.getModel();const a="print";const c=s.bindContext(`/${a}(...)`);c.setParameter("pdf",o);c.setParameter("fileName",l);c.setParameter("printQ",t);c.execute().then(function(){const e=c.getBoundContext();var t=e.fetchValue().getResult();n.show(t.value)}).catch(e=>{console.log(e)})};r.readAsDataURL(i)}).catch(e=>{console.error("Error fetching Blob URL:",e)})},printPreview:function(e){let n=this.getView().byId("ns.labelprintingj::OutbDeliveryItemObjectPage--fe::HeaderFacetCustomContainer::RenderTemplate--printQId").getProperty("selectedKey");let l=this.getView().byId("ns.labelprintingj::OutbDeliveryItemObjectPage--fe::HeaderFacetCustomContainer::RenderTemplate--templateId").getProperty("selectedKey");let r=e.getModel();const o="DNService.render";var s=e.getPath();console.log(s);const a=r.bindContext(`${s}/${o}(...)`);a.setParameter("template",l);a.execute().then(function(){const e=a.getBoundContext();var n=e.getProperty("value");console.log(n);n=n.replaceAll("_","/").replaceAll("-","+");let l=atob(n);n=null;let r=new Array(l.length);for(let e=0;e<l.length;e++){r[e]=l.charCodeAt(e)}l=null;let o=new Uint8Array(r);var s=new Blob([o],{type:"application/pdf"});o=null;const c=URL.createObjectURL(s);let g=new t({Source:c,Title:"Outbound Delivery",Height:"1000px"});i.add("blob");this.getView().byId("ns.labelprintingj::OutbDeliveryItemObjectPage--fe::CustomSubSection::PrintPreview").setVisible(true);this.getView().byId("ns.labelprintingj::OutbDeliveryItemObjectPage--fe::CustomSubSection::PrintPreview--pdfViewId").setModel(g)}.bind(this)).catch(e=>{console.log(e)})},override:{onInit:function(){var e=this.base.getExtensionAPI().getModel()},routing:{onBeforeBinding:async function(e){this.getView().byId("ns.labelprintingj::OutbDeliveryItemObjectPage--fe::CustomAction::PrintPreview").setEnabled(false);this.getView().byId("ns.labelprintingj::OutbDeliveryItemObjectPage--fe::CustomSubSection::PrintPreview").setVisible(false);this.getView().byId("ns.labelprintingj::OutbDeliveryItemObjectPage--fe::CustomAction::Print").setEnabled(false);var n=e.getModel();const i="getTemplates";const l=n.bindContext(`/${i}(...)`);l.execute().then(function(){const e=l.getBoundContext();var n=e.fetchValue().getResult();let i=new t({value:n.value});this.getView().byId("ns.labelprintingj::OutbDeliveryItemObjectPage--fe::HeaderFacetCustomContainer::RenderTemplate--templateId").setModel(i)}.bind(this)).catch(e=>{console.log(e)});const r="getPrintQs";const o=n.bindContext(`/${r}(...)`);o.execute().then(function(){const e=o.getBoundContext();var n=e.fetchValue().getResult();let i=new t({value:n.value});this.getView().byId("ns.labelprintingj::OutbDeliveryItemObjectPage--fe::HeaderFacetCustomContainer::RenderTemplate--printQId").setModel(i)}.bind(this)).catch(e=>{console.log(e)})},onAfterBinding:async function(e){}}}})});
//# sourceMappingURL=ItemObjController.controller.js.map